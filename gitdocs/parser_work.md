### Работа локального парсера подстроенного под llm

#### Общий обзор работы кода

Загружаем документ формата DOCX, преобразуеv его в HTML, а затем извлекаеv оттуда параграфы и таблицы. После извлечения текст из параграфов и таблиц «чанкируется», лемматизируется (опционально), затем загружается в векторное хранилище (FAISS) для последующего семантического поиска. Далее создаётся RetrievalQA цепочка (на базе LangChain), которая по запросам пользователя ищет релевантные куски текста в документе и формирует ответ, используя заданную языковую модель. Кроме того, код содержит логику для прямого запроса к конкретным ячейкам таблицы.

#### Как работает парсинг таблиц в нашем решении

1. Преобразование DOCX в HTML
1. Поиск таблицы в HTML с помощью BeautifulSoup:
1. Извлечение текста из таблиц
1. Создание DataFrame из таблицы, если у таблицы имеется более одной строки, первая строка считается заголовком, а последующие — данными.
1. Обогащение данных таблиц для векторизации. После извлечения таблиц, код в дальнейшем проходит по `data["dataframes"]` и формирует текстовое представление каждой строки.

#### Плюсы и минусы такого подхода

##### Плюсы

1. Универсальность
1. Интеграция с системой векторизации
1. Возможность прямого доступа к ячейкам

##### Минусы

1. Ручное определение заголовков
1. Нет обработки многоуровневых заголовков

### Работа LLaMaParse(baseline)

#### Общий обзор работы

Загружаем документ формата DOCX, и преобразуем его в формат .md или .txt . После извлечения текст из параграфов и таблиц «чанкируется», лемматизируется (опционально), затем загружается в векторное хранилище (FAISS) для последующего семантического поиска. Далее создаётся RetrievalQA цепочка (на базе LangChain), которая по запросам пользователя ищет релевантные куски текста в документе и формирует ответ, используя заданную языковую модель.

#### Плюсы и минусы такого подхода

##### Плюсы

1. Универсальность
1. Интеграция с системой векторизации
1. Простота

##### Минусы

1. Работа с таблицами
1. Нет обработки многоуровневых заголовков
1. Нет обработки заголовков вообще(если выбран txt вариант), по сути "голый" текст и преобразование таблицы в строчку для llm
1. Нет возможности обращаться к на прямую к ячейкам
